<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FeelAware - Duygusal FarkÄ±ndalÄ±k UygulamasÄ±</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            transition: background 0.3s ease;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        body.dark-mode .container {
            background: #2d2d44;
            color: #e0e0e0;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 12px;
            opacity: 0.9;
        }

        .settings-btn {
            position: absolute;
            right: 20px;
            top: 20px;
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            transition: background 0.3s;
        }

        .settings-btn:hover {
            background: rgba(255,255,255,0.5);
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Initial Setup Screen */
        .setup-section {
            text-align: center;
        }

        .setup-section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 20px;
        }

        body.dark-mode .setup-section h2 {
            color: #9db4ff;
        }

        body.dark-mode #consentScreen .setup-section p {
            color: #d0d0d0;
        }

        body.dark-mode #consentScreen label span {
            color: #e0e0e0 !important;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        body.dark-mode .form-group label {
            color: #e0e0e0;
        }

        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            color: #333;
            cursor: pointer;
        }

        body.dark-mode .form-group select {
            background: #3d3d54;
            color: #e0e0e0;
            border-color: #555;
        }

        /* Mood Selection */
        .mood-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .mood-btn {
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
        }

        body.dark-mode .mood-btn {
            background: #3d3d54;
            border-color: #555;
            color: #e0e0e0;
        }

        .mood-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .mood-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* Scale Questions */
        .scale-container {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        body.dark-mode .scale-container {
            background: #3d3d54;
        }

        .scale-container h3 {
            color: #667eea;
            font-size: 14px;
            margin-bottom: 12px;
        }

        body.dark-mode .scale-container h3 {
            color: #9db4ff;
        }

        .question-text {
            font-size: 13px;
            margin-bottom: 8px;
            color: #555;
        }

        body.dark-mode .question-text {
            color: #d0d0d0;
        }

        .likert-options {
            display: flex;
            justify-content: space-between;
            gap: 5px;
            margin-bottom: 15px;
        }

        .likert-btn {
            flex: 1;
            padding: 10px 5px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            color: #333;
        }

        body.dark-mode .likert-btn {
            background: #2d2d44;
            border-color: #555;
            color: #e0e0e0;
        }

        .likert-btn:hover {
            background: #e8eaf6;
        }

        body.dark-mode .likert-btn:hover {
            background: #4d4d64;
        }

        .likert-btn.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        body.dark-mode .btn-secondary {
            background: #3d3d54;
            color: #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        body.dark-mode .btn-secondary:hover {
            background: #4d4d64;
        }

        /* Results Screen */
        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .result-score-wrapper {
            position: relative;
            z-index: 1;
        }

        .result-emoji {
            font-size: 48px;
            margin-bottom: 15px;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .result-card h2 {
            font-size: 42px;
            margin-bottom: 8px;
            font-weight: 700;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .result-card p {
            font-size: 16px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .result-level-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            background: rgba(255,255,255,0.25);
            margin-top: 10px;
            font-size: 14px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .feedback-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 18px;
            border-left: 5px solid #667eea;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feedback-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        body.dark-mode .feedback-section {
            background: #3d3d54;
            border-left-color: #9db4ff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .feedback-section h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        body.dark-mode .feedback-section h3 {
            color: #9db4ff;
        }

        .feedback-section p {
            color: #555;
            font-size: 14px;
            line-height: 1.8;
        }

        body.dark-mode .feedback-section p {
            color: #d0d0d0;
        }

        .feedback-section p strong {
            color: #667eea;
            font-weight: 600;
        }

        body.dark-mode .feedback-section p strong {
            color: #9db4ff;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 12px;
        }

        .detail-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        body.dark-mode .detail-item {
            background: rgba(157, 180, 255, 0.1);
        }

        .detail-label {
            font-size: 11px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        body.dark-mode .detail-value {
            color: #9db4ff;
        }

        /* Dashboard */
        .dashboard-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }

        body.dark-mode .dashboard-tabs {
            border-bottom-color: #555;
        }

        .tab-btn {
            padding: 10px 15px;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 600;
            color: #999;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        body.dark-mode .tab-btn.active {
            color: #9db4ff;
            border-bottom-color: #9db4ff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .history-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.dark-mode .history-item {
            background: #3d3d54;
        }

        .history-item-info {
            flex: 1;
        }

        .history-item-mood {
            font-weight: 600;
            color: #667eea;
        }

        body.dark-mode .history-item-mood {
            color: #9db4ff;
        }

        .history-item-date {
            font-size: 12px;
            color: #999;
        }

        .history-item-score {
            font-weight: 600;
            color: #667eea;
            font-size: 18px;
        }

        /* Settings Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        body.dark-mode .modal-content {
            background: #2d2d44;
            color: #e0e0e0;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-header h2 {
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
        }

        .modal-body {
            padding: 20px;
        }

        .settings-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        body.dark-mode .settings-section {
            border-bottom-color: #555;
        }

        .settings-section:last-child {
            border-bottom: none;
        }

        .settings-section h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 16px;
        }

        body.dark-mode .settings-section h3 {
            color: #9db4ff;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        body.dark-mode .settings-item {
            border-bottom-color: #3d3d54;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 28px;
            background: #ccc;
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #667eea;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: left 0.3s;
        }

        .toggle-switch.active::after {
            left: 24px;
        }

        .info-box {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            color: #666;
            line-height: 1.6;
            margin-top: 10px;
        }

        body.dark-mode .info-box {
            background: #3d3d54;
            color: #b0b0b0;
        }

        .info-box strong {
            color: #667eea;
        }

        body.dark-mode .info-box strong {
            color: #9db4ff;
        }

        .data-stats {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .data-stats h4 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .data-stats p {
            font-size: 12px;
            opacity: 0.9;
        }

        .chart-container {
            position: relative;
            height: 280px;
            margin-bottom: 25px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }

        body.dark-mode .chart-container {
            background: #3d3d54;
        }

        .chart-title {
            text-align: center;
            color: #667eea;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        body.dark-mode .chart-title {
            color: #9db4ff;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        body.dark-mode .empty-state {
            color: #888;
        }

        .ethical-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 12px;
            color: #856404;
        }

        body.dark-mode .ethical-warning {
            background: #664d00;
            border-left-color: #ffc107;
            color: #ffd700;
        }

        .btn-download {
            background: #4caf50;
            color: white;
            margin-top: 8px;
        }

        .btn-download:hover {
            background: #45a049;
        }

        .btn-danger {
            background: #f44336;
            color: white;
            margin-top: 8px;
        }



        .dev-contact a {
            color: #667eea;
            text-decoration: none;
        }

        .dev-contact a:hover {
            text-decoration: underline;
        }

        .btn-danger:hover {
            background: #da190b;
        }

        .btn-inline {
            border: none;
            background: rgba(102,126,234,0.12);
            color: #667eea;
            padding: 8px 10px;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-size: 13px;
        }

        .btn-inline:hover {
            background: rgba(102,126,234,0.20);
        }

        body.dark-mode .btn-inline {
            background: rgba(157,180,255,0.14);
            color: #9db4ff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="settings-btn" onclick="openSettings()">âš™ï¸</button>
            <h1>FeelAware</h1>
            <p>Duygusal FarkÄ±ndalÄ±k UygulamasÄ±</p>
        </div>

        <div class="content">
            <!-- Initial Setup Screen -->
            <div class="screen active" id="setupScreen">
                <div class="ethical-warning">
                    <strong>âš ï¸ Prototip UyarÄ±sÄ±:</strong> Bu uygulama eÄŸitim amaÃ§lÄ± bir prototipdir. Klinik tanÄ± koymaz ve profesyonel psikolojik danÄ±ÅŸmanlÄ±ÄŸÄ±n yerine geÃ§mez.
                </div>
                <div class="setup-section">
                    <h2>HoÅŸ Geldiniz!</h2>
                    <p style="color: #666; margin-bottom: 20px;">LÃ¼tfen baÅŸlamadan Ã¶nce bilgilerinizi girin.</p>

                    <div class="form-group">
                    <label>YaÅŸ AralÄ±ÄŸÄ±</label>
                    <select id="ageRange" onchange="validateSetup()">
                    <option value="">SeÃ§iniz...</option>
                    <option value="13-17">13-17</option>
                    <option value="18-25">18-25</option>
                    <option value="26-35">26-35</option>
                    <option value="36-50">36-50</option>
                    <option value="50+">50+</option>
                    </select>
                    </div>

                    <div class="form-group">
                    <label>Cinsiyet</label>
                    <select id="gender" onchange="validateSetup()">
                    <option value="">SeÃ§iniz...</option>
                    <option value="Erkek">Erkek</option>
                    <option value="KadÄ±n">KadÄ±n</option>
                    <option value="DiÄŸer">DiÄŸer</option>
                    <option value="Belirtmek Ä°stemiyorum">Belirtmek Ä°stemiyorum</option>
                    </select>
                    </div>

                    <div class="form-group">
                    <label>Medeni Hal</label>
                    <select id="maritalStatus" onchange="validateSetup()">
                    <option value="">SeÃ§iniz...</option>
                    <option value="Bekar">Bekar</option>
                    <option value="Ä°liÅŸkisi Var">Ä°liÅŸkisi Var</option>
                    <option value="Evli">Evli</option>
                    <option value="BoÅŸanmÄ±ÅŸ">BoÅŸanmÄ±ÅŸ</option>
                    <option value="Dul">Dul</option>
                    <option value="Belirtmek Ä°stemiyorum">Belirtmek Ä°stemiyorum</option>
                    </select>
                    </div>

                    <div class="form-group">
                    <label>YaÅŸadÄ±ÄŸÄ± BÃ¶lge</label>
                    <select id="region" onchange="validateSetup()">
                    <option value="">SeÃ§iniz...</option>
                    <option value="Marmara">Marmara</option>
                    <option value="Ege">Ege</option>
                    <option value="Akdeniz">Akdeniz</option>
                    <option value="Ä°Ã§ Anadolu">Ä°Ã§ Anadolu</option>
                    <option value="Karadeniz">Karadeniz</option>
                    <option value="DoÄŸu Anadolu">DoÄŸu Anadolu</option>
                    <option value="GÃ¼neydoÄŸu Anadolu">GÃ¼neydoÄŸu Anadolu</option>
                    </select>
                    </div>

                    <button class="btn btn-primary" onclick="startApp()" id="startBtn" disabled>BaÅŸla</button>
                </div>
            </div>

            <!-- Mood Selection Screen -->
            <div class="screen" id="moodScreen">
                <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">Åu anda nasÄ±l hissediyorsunuz?</h2>
                <div class="mood-grid">
                    <button class="mood-btn" onclick="selectMood('KaygÄ±lÄ±')">ğŸ˜° KaygÄ±lÄ±</button>
                    <button class="mood-btn" onclick="selectMood('ÃœzgÃ¼n')">ğŸ˜¢ ÃœzgÃ¼n</button>
                    <button class="mood-btn" onclick="selectMood('Stresli')">ğŸ˜¤ Stresli</button>
                    <button class="mood-btn" onclick="selectMood('Motive')">ğŸš€ Motive</button>
                    <button class="mood-btn" onclick="selectMood('Duygusal KarÄ±ÅŸÄ±klÄ±k')">ğŸ˜• Duygusal KarÄ±ÅŸÄ±klÄ±k</button>
                    <button class="mood-btn" onclick="selectMood('Sakin')">ğŸ˜Œ Sakin</button>
                </div>
                <button class="btn btn-secondary" onclick="goToDashboard()">Panele DÃ¶n</button>
            </div>

            <!-- Scale Questions Screen -->
            <div class="screen" id="scaleScreen">
                <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;" id="scaleTitle"></h2>
                <div id="scalesContainer"></div>
                <button class="btn btn-primary" onclick="submitScales()">SonuÃ§larÄ± GÃ¶r</button>
                <button class="btn btn-secondary" onclick="goToMoodSelection()">Geri DÃ¶n</button>
            </div>

            <!-- Consent Screen (Onay EkranÄ±) -->
            <div class="screen" id="consentScreen">
                <div class="ethical-warning">
                    <strong>ğŸ“Š Veri PaylaÅŸÄ±mÄ± OnayÄ±</strong>
                </div>
                <div class="setup-section">
                    <h2>DeÄŸerlendirme TamamlandÄ±!</h2>
                    <p style="color: #666; margin-bottom: 20px; text-align: left; line-height: 1.6;">
                    Bu uygulamada doldurduÄŸunuz Ã¶lÃ§eklere ait yanÄ±tlar, araÅŸtÄ±rma ve istatistik amaÃ§lÄ± olarak 
                    <strong>anonim bir ÅŸekilde</strong> kayÄ±t altÄ±na alÄ±nacaktÄ±r. Verileriniz, yalnÄ±zca bu amaÃ§larla 
                    kullanÄ±lacak ve kimliÄŸiniz doÄŸrudan tespit edilemeyecek ÅŸekilde saklanacaktÄ±r.
                    </p>
                    <p style="color: #666; margin-bottom: 20px; text-align: left; line-height: 1.6;">
                    Anketi tamamladÄ±ktan sonra aÅŸaÄŸÄ±daki onay kutusunu iÅŸaretleyip 
                    <strong>"Okudum, AnladÄ±m, OnaylÄ±yorum"</strong> butonuna bastÄ±ÄŸÄ±nÄ±zda, yanÄ±tlarÄ±nÄ±z 
                    gÃ¼venli bir ÅŸekilde Google Sheets tablosuna aktarÄ±lacaktÄ±r. Onay vermediÄŸiniz sÃ¼rece 
                    verileriniz kaydedilmeyecektir.
                    </p>

                    <div style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea;">
                    <label style="display: flex; align-items: flex-start; cursor: pointer; margin-bottom: 15px;">
                    <input type="radio" name="consentOption" id="consentFull" value="full" checked style="margin-right: 10px; margin-top: 4px; width: 18px; height: 18px; cursor: pointer;" />
                    <span style="color: #333; font-size: 14px; line-height: 1.5;">
                    AÃ§Ä±klamayÄ± okudum, anladÄ±m ve yanÄ±tlarÄ±mÄ±n anonim olarak Google Sheets'e 
                    kaydedilmesini onaylÄ±yorum.
                    </span>
                    </label>
                    <label style="display: flex; align-items: flex-start; cursor: pointer;">
                    <input type="radio" name="consentOption" id="consentLocal" value="local" style="margin-right: 10px; margin-top: 4px; width: 18px; height: 18px; cursor: pointer;" />
                    <span style="color: #333; font-size: 14px; line-height: 1.5;">
                    Verilerimin Google Sheets'e gÃ¶nderilmesini istemiyorum, sadece bu cihazda (yerel) saklansÄ±n.
                    </span>
                    </label>
                    </div>

                    <button class="btn btn-primary" onclick="submitWithConsent()" id="consentButton">
                    âœ… SeÃ§imi Onayla ve Devam Et
                    </button>

                    <p id="consentStatusMessage" style="font-size: 0.9em; margin-top: 12px; text-align: center; font-weight: 600;"></p>
                </div>
            </div>

            <!-- Results Screen -->
            <div class="screen" id="resultScreen">
                <div class="result-card">
                    <h2 id="resultScore"></h2>
                    <p id="resultLevel"></p>
                </div>

                <div id="feedbackContainer"></div>

                <button class="btn btn-primary" onclick="generatePDF()">ğŸ“„ PDF Rapor Ä°ndir</button>
                <button class="btn btn-secondary" onclick="goToDashboard()">Panele DÃ¶n</button>
            </div>

            <!-- Dashboard Screen -->
            <div class="screen" id="dashboardScreen">
                <div class="dashboard-tabs">
                    <button class="tab-btn active" onclick="switchTab('overview')">Ã–zet</button>
                    <button class="tab-btn" onclick="switchTab('history')">GeÃ§miÅŸ</button>
                    <button class="tab-btn" onclick="switchTab('charts')">Grafikler</button>
                </div>

                <div class="tab-content active" id="overviewTab">
                    <div id="overviewContent"></div>
                    <button class="btn btn-primary" onclick="goToMoodSelection()">Yeni DeÄŸerlendirme</button>
                </div>

                <div class="tab-content" id="historyTab">
                    <div id="historyContent"></div>
                </div>

                <div class="tab-content" id="chartsTab">
                    <div id="chartsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ayarlar</h2>
                <button class="close-btn" onclick="closeSettings()">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- Profile Section -->
                <div class="settings-section">
                    <h3>ğŸ‘¤ Profil Bilgileri</h3>
                    <div class="settings-item">
                    <span>YaÅŸ AralÄ±ÄŸÄ±: <strong id="profileAge">-</strong></span>
                    <button class="btn-inline" onclick="changeProfileField('ageRange')">DeÄŸiÅŸtir</button>
                    </div>
                    <div class="settings-item">
                    <span>Cinsiyet: <strong id="profileGender">-</strong></span>
                    <button class="btn-inline" onclick="changeProfileField('gender')">DeÄŸiÅŸtir</button>
                    </div>
                    <div class="settings-item">
                    <span>Medeni Hal: <strong id="profileMaritalStatus">-</strong></span>
                    <button class="btn-inline" onclick="changeProfileField('maritalStatus')">DeÄŸiÅŸtir</button>
                    </div>
                    <div class="settings-item">
                    <span>BÃ¶lge: <strong id="profileRegion">-</strong></span>
                    <button class="btn-inline" onclick="changeProfileField('region')">DeÄŸiÅŸtir</button>
                    </div>
                    <div class="info-box">
                    <strong>Not:</strong> Profil bilgilerinizi burada gÃ¼ncellediÄŸinizde deÄŸerlendirme verileriniz silinmez.
                    </div>
                </div>

                <!-- Theme Section -->
                <div class="settings-section">
                    <h3>ğŸ¨ Tema</h3>
                    <div class="settings-item">
                    <span>Koyu Mod</span>
                    <div class="toggle-switch" id="darkModeToggle" onclick="toggleDarkMode()"></div>
                    </div>
                </div>

                <!-- Data Overview -->
                <div class="settings-section">
                    <h3>ğŸ“Š KayÄ±tlÄ± Veriler</h3>
                    <div class="data-stats">
                    <h4 id="totalRecords">0</h4>
                    <p>Toplam DeÄŸerlendirme</p>
                    </div>
                    <div id="moodDistribution"></div>
                    <div class="info-box">
                    <strong>ğŸ“Œ Veri Ä°Ã§eriÄŸi:</strong> Her deÄŸerlendirme kaydÄ± ÅŸunlarÄ± iÃ§erir: Tarih-saat, duygu durumu, her soruya verilen ham cevaplar (1-5 arasÄ± Likert puanlarÄ±), toplam puan, seviye (DÃ¼ÅŸÃ¼k/Orta/YÃ¼ksek), ve motivasyonel geri bildirim metni.
                    </div>
                </div>

                <!-- Data Management -->
                <div class="settings-section">
                    <h3>ğŸ’¾ Veri YÃ¶netimi ve Ä°ndirme</h3>
                    <div class="info-box">
                    <strong>ğŸ”¬ Akademik KullanÄ±m:</strong> Ä°ndirdiÄŸiniz dosyalar, araÅŸtÄ±rma ve akademik Ã§alÄ±ÅŸmalarda kullanÄ±lmak Ã¼zere tÃ¼m ham verileri iÃ§erir. JSON formatÄ± Python/R ile, CSV formatÄ± Excel/SPSS ile aÃ§Ä±labilir. TÃ¼m veriler anonim ve sadece bu cihazda saklanÄ±r.
                    </div>
                    <button class="btn btn-download" onclick="exportJSON()">ğŸ“¥ JSON FormatÄ±nda Ä°ndir</button>
                    <button class="btn btn-download" onclick="exportCSV()">ğŸ“¥ CSV FormatÄ±nda Ä°ndir (Excel/SPSS)</button>
                    <button class="btn btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ TÃ¼m Verileri Sil</button>
                </div>

                <!-- Privacy Policy -->
                <div class="settings-section">
                    <h3>ğŸ”’ Gizlilik PolitikasÄ±</h3>
                    <div class="info-box">
                    <strong>Veri GizliliÄŸi:</strong> Bu uygulama tamamen anonim Ã§alÄ±ÅŸÄ±r. HiÃ§bir kiÅŸisel bilgi (ad, e-posta, telefon) toplanmaz. YalnÄ±zca yaÅŸ aralÄ±ÄŸÄ± ve cinsiyet bilgisi cihazÄ±nÄ±zda yerel olarak saklanÄ±r.<br><br>
                    <strong>Saklanan Veriler:</strong> YaÅŸ aralÄ±ÄŸÄ±, cinsiyet, deÄŸerlendirme tarihi-saati, seÃ§ilen duygu durumu, her soruya verilen 1-5 arasÄ± cevaplar, hesaplanan puan ve seviye, geri bildirim metni.<br><br>
                    <strong>Veri GÃ¼venliÄŸi:</strong> TÃ¼m veriler ÅŸifreli ve sadece sizin cihazÄ±nÄ±zda bulunur. HiÃ§bir veri sunucuya gÃ¶nderilmez veya Ã¼Ã§Ã¼ncÃ¼ taraflarla paylaÅŸÄ±lmaz.
                    </div>
                </div>

                <!-- Profile Reset -->
                <div class="settings-section">
                    <button class="btn btn-danger" onclick="resetProfile()">Profili SÄ±fÄ±rla</button>
                    <div class="info-box">
                    <strong>Not:</strong> Profil sÄ±fÄ±rlama; yaÅŸ/cinsiyet/medeni hal/bÃ¶lge ve tÃ¼m deÄŸerlendirme kayÄ±tlarÄ±nÄ± bu cihazdan siler.
                    </div>
                </div>

                
                <!-- Developer Contact -->
                <div class="settings-section">
                    <h3>âœ‰ï¸ GeliÅŸtirici Ä°letiÅŸim</h3>
                    <div class="info-box dev-contact">
                        <div style="padding: 10px; font-weight: 700; color: #333;">SÄ±la ATALAY<br><span id="mail1"></span></div>
                        <div style="padding: 10px; font-weight: 700; color: #333;">Emre Eren ATALAY<br><span id="mail2"></span></div>
                    </div>
                </div>
                <script>
                    document.getElementById('mail1').textContent = 'silaatalay' + '1306' + '@' + 'gmail.com';
                    document.getElementById('mail2').textContent = 'emreerenatalay' + '66' + '@' + 'gmail.com';
                </script>

                <!-- About App -->
                <div class="settings-section">
                    <h3>â„¹ï¸ Uygulama HakkÄ±nda</h3>
                    <div class="info-box">
                    <strong>FeelAware v5.0</strong><br>
                    Duygusal farkÄ±ndalÄ±k ve Ã¶z-deÄŸerlendirme iÃ§in tasarlanmÄ±ÅŸ eÄŸitim amaÃ§lÄ± bir prototip uygulamadÄ±r. Psikoloji Ã¶ÄŸrencileri ve araÅŸtÄ±rmacÄ±lar tarafÄ±ndan kullanÄ±lmak Ã¼zere geliÅŸtirilmiÅŸtir.<br><br>
                    <strong>Yasal UyarÄ±:</strong> Bu uygulama klinik tanÄ± koymaz, tedavi Ã¶nerileri sunmaz ve profesyonel psikolojik danÄ±ÅŸmanlÄ±ÄŸÄ±n yerine geÃ§mez. Ciddi psikolojik sorunlar yaÅŸÄ±yorsanÄ±z lÃ¼tfen bir uzman danÄ±ÅŸmanla iletiÅŸime geÃ§iniz.<br><br>
                    <strong>GeliÅŸtirici Notu:</strong> Bu prototip TÃœBÄ°TAK projesi kapsamÄ±nda YBS Ã¶ÄŸrencisi ve Psikoloji Ã–ÄŸrencisi tarafÄ±ndan geliÅŸtirilmiÅŸtir.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Structure
        const scales = {
            'KaygÄ±lÄ±': [
                {
                    name: 'YaygÄ±n Anksiyete Ã–lÃ§eÄŸi (Ã–rnek)',
                    items: [
                    'EndiÅŸeli hissediyorum',
                    'Kontrol edemediÄŸim ÅŸeyler hakkÄ±nda kaygÄ± duyuyorum',
                    'Ã‡oÄŸu zaman gergin hissediyorum',
                    'KÃ¶tÃ¼ bir ÅŸey olacaÄŸÄ±ndan korkuyorum',
                    'Rahat olamÄ±yorum',
                    'Konsantre olmakta zorluk Ã§ekiyorum'
                    ]
                },
                {
                    name: 'Panik Belirtileri (Ã–rnek)',
                    items: [
                    'Kalp atÄ±ÅŸlarÄ±mda hÄ±zlanma hissediyorum',
                    'Nefes almakta zorluk Ã§ekiyorum',
                    'BaÅŸ dÃ¶nmesi yaÅŸÄ±yorum',
                    'Titremeler hissediyorum',
                    'Terleme problemi yaÅŸÄ±yorum',
                    'BoÄŸulma hissi yaÅŸÄ±yorum'
                    ]
                },
                {
                    name: 'Sosyal KaygÄ± (Ã–rnek)',
                    items: [
                    'Ä°nsanlar Ã¶nÃ¼nde konuÅŸmaktan korkuyorum',
                    'YargÄ±lanmaktan endiÅŸe duyuyorum',
                    'Sosyal durumlardan kaÃ§Ä±nÄ±yorum',
                    'BaÅŸkalarÄ±nÄ±n beni izlemesinden rahatsÄ±z oluyorum',
                    'UtanÃ§ duyma korkusu yaÅŸÄ±yorum',
                    'Yeni insanlarla tanÄ±ÅŸmaktan Ã§ekiniyorum'
                    ]
                }
            ],
            'ÃœzgÃ¼n': [
                {
                    name: 'Depresyon Belirtileri (Ã–rnek)',
                    items: [
                    'Kendimi mutsuz hissediyorum',
                    'HiÃ§bir ÅŸeyden zevk almÄ±yorum',
                    'Umutsuz hissediyorum',
                    'Kendime karÅŸÄ± olumsuz dÃ¼ÅŸÃ¼ncelerim var',
                    'Enerji eksikliÄŸi yaÅŸÄ±yorum',
                    'Uyku sorunlarÄ± yaÅŸÄ±yorum'
                    ]
                },
                {
                    name: 'Duygusal TÃ¼kenme (Ã–rnek)',
                    items: [
                    'Duygusal olarak tÃ¼kenmiÅŸ hissediyorum',
                    'Motivasyon kaybÄ± yaÅŸÄ±yorum',
                    'Sosyal iliÅŸkilerden uzaklaÅŸÄ±yorum',
                    'Kendimi deÄŸersiz hissediyorum',
                    'Gelecek hakkÄ±nda karamsar dÃ¼ÅŸÃ¼nÃ¼yorum',
                    'YalnÄ±zlÄ±k hissediyorum'
                    ]
                },
                {
                    name: 'KayÄ±p ve Yas (Ã–rnek)',
                    items: [
                    'KaybettiÄŸim ÅŸey hakkÄ±nda dÃ¼ÅŸÃ¼nÃ¼yorum',
                    'Duygusal aÄŸrÄ± yaÅŸÄ±yorum',
                    'Kabul etmekte zorluk Ã§ekiyorum',
                    'SuÃ§luluk hissediyorum',
                    'Ã–fke hissediyorum',
                    'YalnÄ±z hissediyorum'
                    ]
                }
            ],
            'Stresli': [
                {
                    name: 'Stres Tepkileri (Ã–rnek)',
                    items: [
                    'Fiziksel olarak gergin hissediyorum',
                    'BaÅŸ aÄŸrÄ±sÄ± yaÅŸÄ±yorum',
                    'Kas aÄŸrÄ±larÄ± hissediyorum',
                    'Sinirli ve asabi hissediyorum',
                    'Konsantre olmakta zorluk Ã§ekiyorum',
                    'SabÄ±rsÄ±z hissediyorum'
                    ]
                },
                {
                    name: 'Ä°ÅŸ/Akademik Stres (Ã–rnek)',
                    items: [
                    'Ä°ÅŸ/okul yÃ¼kÃ¼ beni eziyor',
                    'Zaman baskÄ±sÄ± hissediyorum',
                    'BaÅŸarÄ±sÄ±z olma korkusu yaÅŸÄ±yorum',
                    'Beklentiler altÄ±nda eziliyorum',
                    'Motivasyon kaybÄ± yaÅŸÄ±yorum',
                    'AÅŸÄ±rÄ± yÃ¼klÃ¼ hissediyorum'
                    ]
                },
                {
                    name: 'YaÅŸam StresÃ¶rleri (Ã–rnek)',
                    items: [
                    'Ä°liÅŸki sorunlarÄ± yaÅŸÄ±yorum',
                    'Mali kaygÄ±lar taÅŸÄ±yorum',
                    'SaÄŸlÄ±k endiÅŸeleri yaÅŸÄ±yorum',
                    'Aile sorunlarÄ± var',
                    'Belirsizlik beni rahatsÄ±z ediyor',
                    'Kontrol kaybÄ± hissediyorum'
                    ]
                }
            ],
            'Motive': [
                {
                    name: 'Motivasyon Seviyeleri (Ã–rnek)',
                    items: [
                    'Hedeflerime ulaÅŸmak iÃ§in istekli hissediyorum',
                    'Enerjik ve dinamik hissediyorum',
                    'Yeni ÅŸeyler Ã¶ÄŸrenmeye istekliyim',
                    'ZorluklarÄ± aÅŸmaya hazÄ±rÄ±m',
                    'Kendime gÃ¼venim var',
                    'BaÅŸarÄ± iÃ§in Ã§alÄ±ÅŸmaya istekliyim'
                    ]
                },
                {
                    name: 'KiÅŸisel GeliÅŸim (Ã–rnek)',
                    items: [
                    'Kendimi geliÅŸtirmek istiyorum',
                    'Yeni beceriler Ã¶ÄŸrenmekten heyecanlanÄ±yorum',
                    'Potansiyelimi kullanmak istiyorum',
                    'ZorluklarÄ± fÄ±rsat olarak gÃ¶rÃ¼yorum',
                    'BaÅŸarÄ±larÄ±mdan gurur duyuyorum',
                    'Gelecek hakkÄ±nda iyimser hissediyorum'
                    ]
                },
                {
                    name: 'YaÅŸam Doyumu (Ã–rnek)',
                    items: [
                    'HayatÄ±mdan memnunum',
                    'AnlamlÄ± bir yaÅŸam yaÅŸÄ±yorum',
                    'AmaÃ§larÄ±m var',
                    'Ä°liÅŸkilerimden memnunum',
                    'Kendimi deÄŸerli hissediyorum',
                    'Gelecekten umutluyum'
                    ]
                }
            ],
            'Duygusal KarÄ±ÅŸÄ±klÄ±k': [
                {
                    name: 'Duygusal Dengesizlik (Ã–rnek)',
                    items: [
                    'DuygularÄ±mÄ± kontrol edemiyorum',
                    'Ani duygu deÄŸiÅŸiklikleri yaÅŸÄ±yorum',
                    'DuygularÄ±mÄ± anlamakta zorluk Ã§ekiyorum',
                    'AÅŸÄ±rÄ± tepkiler veriyorum',
                    'Duygusal olarak istikrarsÄ±z hissediyorum',
                    'DuygularÄ±mÄ± ifade etmekte zorluk Ã§ekiyorum'
                    ]
                },
                {
                    name: 'Kimlik BelirsizliÄŸi (Ã–rnek)',
                    items: [
                    'Kendimi tanÄ±makta zorluk Ã§ekiyorum',
                    'DeÄŸerlerim hakkÄ±nda emin deÄŸilim',
                    'YaÅŸam yÃ¶nÃ¼mÃ¼ bilmiyorum',
                    'KimliÄŸim hakkÄ±nda karÄ±ÅŸÄ±k hissediyorum',
                    'Kararlar almakta zorluk Ã§ekiyorum',
                    'Kendimi kaybolmuÅŸ hissediyorum'
                    ]
                },
                {
                    name: 'Ä°liÅŸki KarÄ±ÅŸÄ±klÄ±ÄŸÄ± (Ã–rnek)',
                    items: [
                    'Ä°liÅŸkilerimde belirsizlik var',
                    'BaÅŸkalarÄ±nÄ± anlamakta zorluk Ã§ekiyorum',
                    'BaÄŸlanma sorunlarÄ± yaÅŸÄ±yorum',
                    'GÃ¼ven sorunlarÄ± var',
                    'SÄ±nÄ±rlarÄ± belirlemekte zorluk Ã§ekiyorum',
                    'Sosyal iliÅŸkilerimde karÄ±ÅŸÄ±klÄ±k yaÅŸÄ±yorum'
                    ]
                }
            ],
            'Sakin': [
                {
                    name: 'RahatlÄ±k ve Huzur (Ã–rnek)',
                    items: [
                    'Kendimi rahat hissediyorum',
                    'Zihinsel olarak sakin hissediyorum',
                    'Fiziksel olarak gevÅŸek hissediyorum',
                    'Ä°Ã§ huzuru yaÅŸÄ±yorum',
                    'Dengeli hissediyorum',
                    'BarÄ±ÅŸÃ§Ä±l hissediyorum'
                    ]
                },
                {
                    name: 'FarkÄ±ndalÄ±k ve Mevcudiyet (Ã–rnek)',
                    items: [
                    'Åu ana odaklanabiliyorum',
                    'Ã‡evremde farkÄ±ndalÄ±ÄŸÄ±m var',
                    'Meditasyona benzer bir durum yaÅŸÄ±yorum',
                    'Zihinsel aÃ§Ä±klÄ±k hissediyorum',
                    'BaÄŸlantÄ±lÄ± hissediyorum',
                    'VarlÄ±ÄŸÄ±mÄ±n farkÄ±ndayÄ±m'
                    ]
                },
                {
                    name: 'YaÅŸam Tatmini (Ã–rnek)',
                    items: [
                    'HayatÄ±mdan memnunum',
                    'ÅÃ¼kran hissediyorum',
                    'AnlamlÄ± bir yaÅŸam yaÅŸÄ±yorum',
                    'BaÄŸlantÄ±lÄ± hissediyorum',
                    'AmaÃ§lÄ± hissediyorum',
                    'Mutlu hissediyorum'
                    ]
                }
            ]
        };

        const feedbackTexts = {
            'KaygÄ±lÄ±': {
                'Low': 'ğŸŒŸ Harika! KaygÄ± seviyeleriniz dÃ¼ÅŸÃ¼k. EndiÅŸelerinizi iyi yÃ¶netebiliyor gÃ¶rÃ¼nÃ¼yorsunuz. Bunu sÃ¼rdÃ¼rmek iÃ§in gÃ¼nlÃ¼k meditasyon veya derin nefes egzersizleri yapabilirsiniz. Kendinize gÃ¼venin ve ileriye bakÄ±n!',
                'Medium': 'ğŸ’ª KaygÄ± seviyeleriniz orta dÃ¼zeyde. Bu normal ve yaygÄ±ndÄ±r. KaygÄ±yÄ± yÃ¶netmek iÃ§in: (1) Nefes egzersizleri yapÄ±n, (2) Fiziksel aktivite artÄ±rÄ±n, (3) Uyku dÃ¼zeninizi iyileÅŸtirin, (4) EndiÅŸelerinizi yazÄ±n. Kademeli olarak iyileÅŸeceksiniz!',
                'High': 'ğŸ¤ KaygÄ± seviyeleriniz yÃ¼ksek. Bu zor bir dÃ¶nem geÃ§iriyor olabilirsiniz. LÃ¼tfen: (1) Profesyonel yardÄ±m almayÄ± dÃ¼ÅŸÃ¼nÃ¼n, (2) Stres yÃ¶netimi tekniklerini Ã¶ÄŸrenin, (3) Sosyal destek arayÄ±n, (4) Fiziksel aktivite yapÄ±n. Siz gÃ¼Ã§lÃ¼sÃ¼nÃ¼z ve bu geÃ§ecek!'
            },
            'ÃœzgÃ¼n': {
                'Low': 'âœ¨ Ã‡ok iyi! Duygusal durumunuz olumlu. Bu duyguyu korumak iÃ§in sevdiklerinizle zaman geÃ§irin, hobi yapÄ±n ve kendinize iyi bakÄ±n. MutluluÄŸunuzu paylaÅŸÄ±n!',
                'Medium': 'ğŸŒˆ Biraz Ã¼zÃ¼ntÃ¼ hissediyorsunuz. Bu doÄŸal bir duygudur. Kendinize ÅŸefkat gÃ¶sterin, sevdiklerinizle konuÅŸun, aktiviteler yapÄ±n. Zaman iÃ§inde iyileÅŸeceksiniz. Kendinize inanÄ±n!',
                'High': 'ğŸ’™ Ciddi bir Ã¼zÃ¼ntÃ¼ yaÅŸÄ±yor gÃ¶rÃ¼nÃ¼yorsunuz. Bu Ã¶nemli bir sinyaldir. LÃ¼tfen: (1) GÃ¼vendiÄŸiniz birine anlatÄ±n, (2) Profesyonel destek arayÄ±n, (3) Kendinize ÅŸefkat gÃ¶sterin, (4) GÃ¼nlÃ¼k rutinler oluÅŸturun. Siz deÄŸerlisiniz ve bu geÃ§ecek!'
            },
            'Stresli': {
                'Low': 'ğŸ¯ Stres seviyeleriniz dÃ¼ÅŸÃ¼k! Harika bir durumdaysÄ±nÄ±z. Bu dengeyi korumak iÃ§in dÃ¼zenli egzersiz yapÄ±n, yeterli uyku alÄ±n ve sÄ±nÄ±rlar belirleyin. BaÅŸarÄ±lÄ± olduÄŸunuz iÃ§in kendinizi kutlayÄ±n!',
                'Medium': 'âš¡ Orta dÃ¼zey stres yaÅŸÄ±yorsunuz. Bu yÃ¶netilebilir. Deneyin: (1) Zaman yÃ¶netimi iyileÅŸtirin, (2) KÄ±sa molalar verin, (3) Fiziksel aktivite yapÄ±n, (4) Sosyal destek alÄ±n. AdÄ±m adÄ±m ilerleyin!',
                'High': 'ğŸ›¡ï¸ YÃ¼ksek stres altÄ±ndasÄ±nÄ±z. Acil olarak: (1) Stres kaynaÄŸÄ±nÄ± belirleyin, (2) Profesyonel yardÄ±m alÄ±n, (3) Kendinize zaman ayÄ±rÄ±n, (4) SaÄŸlÄ±klÄ± yaÅŸam alÄ±ÅŸkanlÄ±klarÄ± geliÅŸtirin. Siz bu durumdan Ã§Ä±kabilirsiniz!'
            },
            'Motive': {
                'Low': 'ğŸŒ± Motivasyon eksikliÄŸi yaÅŸÄ±yorsunuz. Bu geÃ§ici olabilir. Deneyin: (1) KÃ¼Ã§Ã¼k hedefler belirleyin, (2) BaÅŸarÄ±larÄ±nÄ±zÄ± kutlayÄ±n, (3) Ä°lham kaynaklarÄ± bulun, (4) Sosyal destek alÄ±n. YavaÅŸ yavaÅŸ enerji kazanacaksÄ±nÄ±z!',
                'Medium': 'ğŸš€ Motivasyon seviyeleriniz orta dÃ¼zeyde. Bunu artÄ±rmak iÃ§in: (1) AnlamlÄ± hedefler belirleyin, (2) Ä°lerlemenizi takip edin, (3) Kendinizi Ã¶dÃ¼llendirin, (4) BaÅŸkalarÄ±yla paylaÅŸÄ±n. Siz yapabilirsiniz!',
                'High': 'ğŸ† Harika! YÃ¼ksek motivasyonla dolu gÃ¶rÃ¼nÃ¼yorsunuz! Bu enerjiyi kullanarak hedeflerinize ulaÅŸÄ±n. BaÅŸkalarÄ±nÄ± da ilham verin. Momentum devam ettirin ve baÅŸarÄ±ya ulaÅŸÄ±n!'
            },
            'Duygusal KarÄ±ÅŸÄ±klÄ±k': {
                'Low': 'ğŸ§˜ Duygusal durumunuz net ve dengeli. Harika! Bu netliÄŸi korumak iÃ§in kendinize zaman ayÄ±rÄ±n ve duygularÄ±nÄ±zÄ± takip edin. Kendinize gÃ¼venin!',
                'Medium': 'ğŸŒŠ Biraz duygusal karÄ±ÅŸÄ±klÄ±k yaÅŸÄ±yorsunuz. Bu normal. Deneyin: (1) DuygularÄ±nÄ±zÄ± yazÄ±n, (2) Meditasyon yapÄ±n, (3) GÃ¼vendiÄŸiniz birine konuÅŸun, (4) Zaman ayÄ±rÄ±n. Netlik kazanacaksÄ±nÄ±z!',
                'High': 'ğŸ§­ Duygusal olarak karÄ±ÅŸÄ±k hissediyorsunuz. LÃ¼tfen: (1) DuygularÄ±nÄ±zÄ± tanÄ±yÄ±n, (2) Profesyonel yardÄ±m alÄ±n, (3) Kendinize ÅŸefkat gÃ¶sterin, (4) GÃ¼nlÃ¼k rutinler oluÅŸturun. Netlik kazanacaksÄ±nÄ±z!'
            },
            'Sakin': {
                'Low': 'ğŸƒ Sakinlik seviyeleriniz dÃ¼ÅŸÃ¼k. Daha fazla huzur bulmak iÃ§in: (1) Meditasyon yapÄ±n, (2) DoÄŸada zaman geÃ§irin, (3) Nefes egzersizleri yapÄ±n, (4) Sosyal aktiviteler azaltÄ±n. Huzur bulacaksÄ±nÄ±z!',
                'Medium': 'ğŸŒ¸ Orta dÃ¼zey sakinlik yaÅŸÄ±yorsunuz. Bunu artÄ±rmak iÃ§in: (1) GÃ¼nlÃ¼k meditasyon yapÄ±n, (2) Yoga deneyin, (3) DoÄŸada zaman geÃ§irin, (4) Uyku kalitesini iyileÅŸtirin. Daha sakin olacaksÄ±nÄ±z!',
                'High': 'â˜®ï¸ Harika! YÃ¼ksek sakinlik ve huzur iÃ§indesiniz. Bu gÃ¼zel durumu korumak iÃ§in meditasyon, yoga ve doÄŸa ile baÄŸlantÄ± kurun. Bu huzuru baÅŸkalarÄ±yla paylaÅŸÄ±n!'
            }
        };

        let currentMood = null;
        let currentResponses = {};
        let pendingRecord = null; // Onay bekleyen kayÄ±t
        let userData = {
            ageRange: null,
            gender: null,
            maritalStatus: null,
            region: null,
            records: []
        };

        let moodChart = null;
        let scoreChart = null;

        // Google Sheets Web App URL
        const GSHEET_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwIbRL8F5208AvI8KSUCwfzCIqzMrqn5M8MUb3uBhPzTYoOBYZhBFnTXekYxv_deY8/exec";

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('feelawareData');
            if (saved) {
                userData = JSON.parse(saved);
                updateProfileDisplay();
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('feelawareData', JSON.stringify(userData));
        }

        // Update profile display
        function updateProfileDisplay() {
            document.getElementById('profileAge').textContent = userData.ageRange || '-';
            document.getElementById('profileGender').textContent = userData.gender || '-';
            document.getElementById('profileMaritalStatus').textContent = userData.maritalStatus || '-';
            document.getElementById('profileRegion').textContent = userData.region || '-';
            document.getElementById('totalRecords').textContent = userData.records.length;
            updateMoodDistribution();
        }

        // Update mood distribution in settings
        function updateMoodDistribution() {
            const container = document.getElementById('moodDistribution');
            if (userData.records.length === 0) {
                container.innerHTML = '<div class="info-box">HenÃ¼z deÄŸerlendirme yapÄ±lmamÄ±ÅŸ.</div>';
                return;
            }

            const moodCounts = {};
            userData.records.forEach(r => {
                moodCounts[r.mood] = (moodCounts[r.mood] || 0) + 1;
            });

            let html = '<div class="info-box"><strong>Duygu DaÄŸÄ±lÄ±mÄ±:</strong><br>';
            for (const [mood, count] of Object.entries(moodCounts)) {
                html += `${mood}: ${count} deÄŸerlendirme<br>`;
            }
            html += '</div>';
            container.innerHTML = html;
        }

        // Validate setup
        function validateSetup() {
            const age = document.getElementById('ageRange').value;
            const gender = document.getElementById('gender').value;
            const maritalStatus = document.getElementById('maritalStatus').value;
            const region = document.getElementById('region').value;
            document.getElementById('startBtn').disabled = !age || !gender || !maritalStatus || !region;
        }

        // Start app
        function startApp() {
            userData.ageRange = document.getElementById('ageRange').value;
            userData.gender = document.getElementById('gender').value;
            userData.maritalStatus = document.getElementById('maritalStatus').value;
            userData.region = document.getElementById('region').value;
            saveData();
            updateProfileDisplay();
            goToDashboard();
        }

        // Screen navigation
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function goToMoodSelection() {
            showScreen('moodScreen');
        }

        function goToDashboard() {
            showScreen('dashboardScreen');
            updateDashboard();
        }

        // Mood selection
        function selectMood(mood) {
            currentMood = mood;
            currentResponses = {};
            document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');

            setTimeout(() => {
                showScreen('scaleScreen');
                document.getElementById('scaleTitle').textContent = mood + ' - DeÄŸerlendirme Ã–lÃ§ekleri';
                renderScales();
            }, 300);
        }

        // Render scales
        function renderScales() {
            const container = document.getElementById('scalesContainer');
            container.innerHTML = '';
            const moodScales = scales[currentMood] || [];

            moodScales.forEach((scale, scaleIdx) => {
                const scaleDiv = document.createElement('div');
                scaleDiv.className = 'scale-container';
                scaleDiv.innerHTML = `<h3>${scale.name}</h3>`;

                scale.items.forEach((item, itemIdx) => {
                    const questionId = `s${scaleIdx}_q${itemIdx}`;
                    const itemDiv = document.createElement('div');
                    itemDiv.style.marginBottom = '15px';
                    itemDiv.innerHTML = `<p class="question-text">${itemIdx + 1}. ${item}</p>`;

                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'likert-options';

                    const labels = ['HiÃ§', 'Az', 'Orta', 'Ã‡ok', 'AÅŸÄ±rÄ±'];
                    for (let i = 1; i <= 5; i++) {
                    const btn = document.createElement('button');
                    btn.className = 'likert-btn';
                    btn.innerHTML = `${i}<br><small>${labels[i-1]}</small>`;
                    btn.onclick = () => selectLikert(questionId, i, btn);
                    btn.setAttribute('data-question', questionId);
                    optionsDiv.appendChild(btn);
                    }

                    itemDiv.appendChild(optionsDiv);
                    scaleDiv.appendChild(itemDiv);
                });

                container.appendChild(scaleDiv);
            });
        }

        // Select Likert response
        function selectLikert(questionId, value, btn) {
            document.querySelectorAll(`[data-question="${questionId}"]`).forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            currentResponses[questionId] = value;
        }

        // Submit scales
        function submitScales() {
            const moodScales = scales[currentMood] || [];
            const totalQuestions = moodScales.reduce((sum, scale) => sum + scale.items.length, 0);

            if (Object.keys(currentResponses).length < totalQuestions) {
                alert('LÃ¼tfen tÃ¼m sorularÄ± cevaplayÄ±n!');
                return;
            }

            let totalScore = 0;
            for (const value of Object.values(currentResponses)) {
                totalScore += value;
            }

            const averageScore = totalScore / totalQuestions;
            const level = averageScore <= 2 ? 'Low' : averageScore <= 3.5 ? 'Medium' : 'High';
            const feedback = feedbackTexts[currentMood][level];

            // KaydÄ± oluÅŸtur ama henÃ¼z kaydetme - onay beklesin
            pendingRecord = {
                date: new Date().toLocaleDateString('tr-TR'),
                time: new Date().toLocaleTimeString('tr-TR'),
                timestamp: new Date().toISOString(),
                mood: currentMood,
                responses: {...currentResponses},
                totalScore: totalScore,
                averageScore: averageScore.toFixed(2),
                score: Math.round(averageScore * 20),
                level: level,
                levelText: level === 'Low' ? 'DÃ¼ÅŸÃ¼k' : level === 'Medium' ? 'Orta' : 'YÃ¼ksek',
                feedback: feedback
            };

            // Onay ekranÄ±na yÃ¶nlendir
            showScreen('consentScreen');
            document.getElementById('consentStatusMessage').textContent = '';
        }

        // Submit with consent - Onay verilince Google Sheets'e gÃ¶nder
        async function submitWithConsent() {
            const consentFull = document.getElementById('consentFull');
            const status = document.getElementById('consentStatusMessage');
            const button = document.getElementById('consentButton');

            if (!pendingRecord) {
                status.textContent = 'âŒ Bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.';
                status.style.color = '#f44336';
                return;
            }

            // Butonu devre dÄ±ÅŸÄ± bÄ±rak
            button.disabled = true;
            button.textContent = 'â³ Kaydediliyor...';
            
            // Her durumda yerel olarak sakla
            userData.records.push(pendingRecord);
            saveData();
            updateProfileDisplay();

            // Google Sheets'e gÃ¶nder (EÄŸer kullanÄ±cÄ± onay verdiyse ve URL varsa)
            if (consentFull.checked && GSHEET_WEBAPP_URL) {
                status.textContent = 'OnayÄ±nÄ±z alÄ±ndÄ±, verileriniz Google Sheets\'e kaydediliyor...';
                status.style.color = '#667eea';

                try {
                    const moodScales = scales[currentMood] || [];
                    const rowsToSend = [];

                    moodScales.forEach((scale, scaleIdx) => {
                    let scaleScore = 0;
                    let scaleQuestionCount = 0;

                    for (let itemIdx = 0; itemIdx < scale.items.length; itemIdx++) {
                    const questionId = `s${scaleIdx}_q${itemIdx}`;
                    if (pendingRecord.responses[questionId]) {
                    scaleScore += pendingRecord.responses[questionId];
                    scaleQuestionCount++;
                    }
                    }

                    rowsToSend.push([
                    pendingRecord.timestamp,
                    userData.ageRange,
                    userData.gender,
                    userData.maritalStatus,
                    userData.region,
                    scale.name,
                    currentMood,
                    scaleScore
                    ]);
                    });

                    await fetch(GSHEET_WEBAPP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(rowsToSend)
                    });

                    status.textContent = 'âœ… TeÅŸekkÃ¼rler! YanÄ±tlarÄ±nÄ±z baÅŸarÄ±yla kaydedildi.';
                    status.style.color = '#4caf50';
                } catch (e) {
                    console.error('Google Sheets gÃ¶nderim hatasÄ±:', e);
                    status.textContent = 'âš ï¸ Veriler gÃ¶nderilemedi ancak bu cihaza kaydedildi.';
                    status.style.color = '#ff9800';
                }
            } else {
                status.textContent = 'âœ… YanÄ±tlarÄ±nÄ±z bu cihaza kaydedildi.';
                status.style.color = '#4caf50';
            }

            // SonuÃ§ ekranÄ±na geÃ§
            const recordToShow = {...pendingRecord};
            setTimeout(() => {
                showResult(recordToShow);
                pendingRecord = null;
                button.disabled = false;
                button.textContent = 'âœ… SeÃ§imi Onayla ve Devam Et';
            }, 1500);
        }

        // Show result
        function showResult(record) {
            showScreen('resultScreen');
            
            // Emoji seÃ§imi
            const emojiMap = {
                'Low': 'ğŸ˜Š',
                'Medium': 'ğŸ˜',
                'High': 'ğŸ˜Ÿ'
            };
            const emoji = emojiMap[record.level] || 'ğŸ˜Š';
            
            // Seviye metni ve badge rengi
            const levelInfo = {
                'Low': { text: 'DÃ¼ÅŸÃ¼k Seviye', icon: 'âœ…' },
                'Medium': { text: 'Orta Seviye', icon: 'âš ï¸' },
                'High': { text: 'YÃ¼ksek Seviye', icon: 'ğŸ”´' }
            };
            const levelData = levelInfo[record.level] || levelInfo['Low'];
            
            // Result card'Ä± gÃ¼ncelle
            const resultCard = document.querySelector('#resultScreen .result-card');
            resultCard.innerHTML = `
                <div class="result-score-wrapper">
                    <div class="result-emoji">${emoji}</div>
                    <h2>${record.score}/100</h2>
                    <p>${record.mood}</p>
                    <div class="result-level-badge">${levelData.icon} ${levelData.text}</div>
                </div>
            `;

            const feedbackContainer = document.getElementById('feedbackContainer');
            feedbackContainer.innerHTML = `
                <div class="feedback-section">
                    <h3>ğŸ’¡ Motivasyonel Rehberlik</h3>
                    <p>${record.feedback}</p>
                </div>
                <div class="feedback-section">
                    <h3>ğŸ“Š DeÄŸerlendirme DetaylarÄ±</h3>
                    <p style="margin-bottom: 15px;"><strong>Duygu Durumu:</strong> ${record.mood}</p>
                    <div class="detail-grid">
                    <div class="detail-item">
                    <div class="detail-label">Toplam Puan</div>
                    <div class="detail-value">${record.totalScore}/${Object.keys(record.responses).length * 5}</div>
                    </div>
                    <div class="detail-item">
                    <div class="detail-label">Ortalama</div>
                    <div class="detail-value">${record.averageScore}/5.00</div>
                    </div>
                    <div class="detail-item">
                    <div class="detail-label">Tarih</div>
                    <div class="detail-value" style="font-size: 13px;">${record.date}</div>
                    </div>
                    <div class="detail-item">
                    <div class="detail-label">Saat</div>
                    <div class="detail-value" style="font-size: 13px;">${record.time}</div>
                    </div>
                    </div>
                </div>
            `;
        }

        // Generate PDF
        function generatePDF() {
            const record = userData.records[userData.records.length - 1];
            const element = document.createElement('div');
            element.style.padding = '20px';
            element.style.fontFamily = 'Arial, sans-serif';
            element.innerHTML = `
                <h1 style="color: #667eea; text-align: center;">FeelAware DeÄŸerlendirme Raporu</h1>
                <p style="text-align: center; color: #999; margin-bottom: 20px;">EÄŸitim AmaÃ§lÄ± Prototip</p>

                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p><strong>Tarih:</strong> ${record.date} ${record.time}</p>
                    <p><strong>DeÄŸerlendirilen Duygu Durumu:</strong> ${record.mood}</p>
                    <p><strong>Puan:</strong> ${record.score}/100</p>
                    <p><strong>Seviye:</strong> ${record.levelText}</p>
                    <p><strong>Ortalama Skor:</strong> ${record.averageScore}/5.00</p>
                </div>

                <h2 style="color: #667eea; margin-top: 20px;">Motivasyonel Rehberlik</h2>
                <p style="line-height: 1.6;">${record.feedback}</p>

                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin-top: 20px; border-radius: 6px;">
                    <p style="font-size: 12px; color: #856404;">
                    <strong>âš ï¸ Yasal UyarÄ±:</strong> Bu rapor eÄŸitim amaÃ§lÄ± bir prototip uygulamasÄ±ndan oluÅŸturulmuÅŸtur. Klinik tanÄ± koymaz, tedavi Ã¶nerileri sunmaz ve profesyonel psikolojik danÄ±ÅŸmanlÄ±ÄŸÄ±n yerine geÃ§mez. Ciddi psikolojik sorunlar yaÅŸÄ±yorsanÄ±z lÃ¼tfen bir uzman danÄ±ÅŸmanla iletiÅŸime geÃ§iniz.
                    </p>
                </div>
            `;

            html2pdf().set({
                margin: 10,
                filename: `FeelAware_Rapor_${record.date.replace(/\./g, '-')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            }).from(element).save();
        }

        // Dashboard
        function updateDashboard() {
            updateOverview();
            updateHistory();
        }

        function updateOverview() {
            const container = document.getElementById('overviewContent');
            if (userData.records.length === 0) {
                container.innerHTML = '<div class="empty-state">HenÃ¼z deÄŸerlendirme yapÄ±lmamÄ±ÅŸ. Yeni bir deÄŸerlendirme baÅŸlatÄ±n!</div>';
                return;
            }

            const lastRecord = userData.records[userData.records.length - 1];
            container.innerHTML = `
                <div class="result-card">
                    <h2>${lastRecord.score}/100</h2>
                    <p>${lastRecord.mood} - ${lastRecord.date}</p>
                </div>
                <div class="feedback-section">
                    <h3>Son DeÄŸerlendirme</h3>
                    <p><strong>Duygu Durumu:</strong> ${lastRecord.mood}</p>
                    <p><strong>Puan:</strong> ${lastRecord.score}/100</p>
                    <p><strong>Seviye:</strong> ${lastRecord.levelText}</p>
                    <p><strong>Tarih:</strong> ${lastRecord.date} ${lastRecord.time}</p>
                </div>
                <div class="data-stats">
                    <h4>${userData.records.length}</h4>
                    <p>Toplam DeÄŸerlendirme</p>
                </div>
            `;
        }

        function updateHistory() {
            const container = document.getElementById('historyContent');
            if (userData.records.length === 0) {
                container.innerHTML = '<div class="empty-state">HenÃ¼z deÄŸerlendirme yapÄ±lmamÄ±ÅŸ.</div>';
                return;
            }

            container.innerHTML = userData.records.slice().reverse().map((record, idx) => `
                <div class="history-item">
                    <div class="history-item-info">
                    <div class="history-item-mood">${record.mood}</div>
                    <div class="history-item-date">${record.date} ${record.time}</div>
                    </div>
                    <div class="history-item-score">${record.score}</div>
                </div>
            `).join('');
        }

        function updateCharts() {
            const container = document.getElementById('chartsContent');

            if (userData.records.length === 0) {
                container.innerHTML = '<div class="empty-state">ğŸ“Š Grafik gÃ¶rmek iÃ§in en az 1 deÄŸerlendirme yapmalÄ±sÄ±nÄ±z.</div>';
                return;
            }

            // Clear previous charts
            if (moodChart) moodChart.destroy();
            if (scoreChart) scoreChart.destroy();

            container.innerHTML = `
                <div class="chart-container">
                    <div class="chart-title">ğŸ“Š Duygulara GÃ¶re DeÄŸerlendirme DaÄŸÄ±lÄ±mÄ±</div>
                    <canvas id="moodChartCanvas"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">ğŸ“ˆ Zaman Ä°Ã§inde Puan Trendi</div>
                    <canvas id="scoreChartCanvas"></canvas>
                </div>
            `;

            // Mood distribution chart
            const moodCounts = {};
            userData.records.forEach(r => {
                moodCounts[r.mood] = (moodCounts[r.mood] || 0) + 1;
            });

            const moodCtx = document.getElementById('moodChartCanvas').getContext('2d');
            moodChart = new Chart(moodCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(moodCounts),
                    datasets: [{
                    data: Object.values(moodCounts),
                    backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#00f2fe', '#43e97b']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                    legend: {
                    position: 'bottom',
                    labels: {
                    padding: 10,
                    font: { size: 11 }
                    }
                    }
                    }
                }
            });

            // Score trend chart
            const scoreCtx = document.getElementById('scoreChartCanvas').getContext('2d');
            scoreChart = new Chart(scoreCtx, {
                type: 'line',
                data: {
                    labels: userData.records.map((r, i) => `${i + 1}. ${r.date}`),
                    datasets: [{
                    label: 'Puan Trendi',
                    data: userData.records.map(r => r.score),
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    tension: 0.4,
                    fill: true,
                    pointRadius: 4,
                    pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                    legend: {
                    display: true,
                    position: 'top'
                    }
                    },
                    scales: {
                    y: {
                    beginAtZero: true,
                    max: 100,
                    ticks: {
                    stepSize: 20
                    }
                    }
                    }
                }
            });
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tab + 'Tab').classList.add('active');
            event.target.classList.add('active');

            if (tab === 'charts') {
                updateCharts();
            }
        }

        // Settings
        function openSettings() {
            updateProfileDisplay();
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            document.getElementById('darkModeToggle').classList.toggle('active');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        
        function changeProfileField(field) {
            let newValue = "";
            let options = "";

            if (field === 'ageRange') {
                options = "13-17, 18-25, 26-35, 36-50, 50+";
                newValue = prompt(`Yeni yaÅŸ aralÄ±ÄŸÄ±nÄ± girin (${options}):`, userData.ageRange);
                if (newValue && !["13-17", "18-25", "26-35", "36-50", "50+"].includes(newValue)) {
                    alert("LÃ¼tfen geÃ§erli bir yaÅŸ aralÄ±ÄŸÄ± girin.");
                    return;
                }
            } else if (field === 'gender') {
                options = "Erkek, KadÄ±n, DiÄŸer, Belirtmek Ä°stemiyorum";
                newValue = prompt(`Yeni cinsiyet bilgisini girin (${options}):`, userData.gender);
                if (newValue && !["Erkek", "KadÄ±n", "DiÄŸer", "Belirtmek Ä°stemiyorum"].includes(newValue)) {
                    alert("LÃ¼tfen geÃ§erli bir cinsiyet girin.");
                    return;
                }
            } else if (field === 'maritalStatus') {
                options = "Bekar, Ä°liÅŸkisi Var, Evli, BoÅŸanmÄ±ÅŸ, Dul, Belirtmek Ä°stemiyorum";
                newValue = prompt(`Yeni medeni hal bilgisini girin (${options}):`, userData.maritalStatus);
                if (newValue && !["Bekar", "Ä°liÅŸkisi Var", "Evli", "BoÅŸanmÄ±ÅŸ", "Dul", "Belirtmek Ä°stemiyorum"].includes(newValue)) {
                    alert("LÃ¼tfen geÃ§erli bir medeni hal girin.");
                    return;
                }
            } else if (field === 'region') {
                options = "Marmara, Ege, Akdeniz, Ä°Ã§ Anadolu, Karadeniz, DoÄŸu Anadolu, GÃ¼neydoÄŸu Anadolu";
                newValue = prompt(`Yeni bÃ¶lge bilgisini girin (${options}):`, userData.region);
                if (newValue && !["Marmara", "Ege", "Akdeniz", "Ä°Ã§ Anadolu", "Karadeniz", "DoÄŸu Anadolu", "GÃ¼neydoÄŸu Anadolu"].includes(newValue)) {
                    alert("LÃ¼tfen geÃ§erli bir bÃ¶lge girin.");
                    return;
                }
            }

            if (newValue) {
                userData[field] = newValue;
                saveData();
                updateProfileDisplay();
                alert("Profil bilgisi gÃ¼ncellendi.");
            }
        }

        function editProfile() {
            const ageOptions = ['13-17', '18-25', '26-35', '36-50', '50+'];
            const newAge = prompt('Yeni yaÅŸ aralÄ±ÄŸÄ± seÃ§in (13-17, 18-25, 26-35, 36-50, 50+):', userData.ageRange);
            if (newAge && ageOptions.includes(newAge)) {
                userData.ageRange = newAge;
                saveData();
                updateProfileDisplay();
            } else if (newAge) {
                alert('GeÃ§ersiz yaÅŸ aralÄ±ÄŸÄ±. LÃ¼tfen listeden birini seÃ§in.');
            }
        }

        // Export JSON
        function exportJSON() {
            if (userData.records.length === 0) {
                alert('Ä°ndirilecek veri yok. Ã–nce en az bir deÄŸerlendirme yapÄ±n.');
                return;
            }

            const dataStr = JSON.stringify(userData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `feelaware_data_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            alert('JSON dosyasÄ± indirildi! Python/R ile analiz edebilirsiniz.');
        }

        // Export CSV
        function exportCSV() {
            if (userData.records.length === 0) {
                alert('Ä°ndirilecek veri yok. Ã–nce en az bir deÄŸerlendirme yapÄ±n.');
                return;
            }

            let csv = 'Tarih,Saat,Timestamp,Yas_Araligi,Cinsiyet,Duygu_Durumu,';

            // Add question headers
            const firstRecord = userData.records[0];
            const questionCount = Object.keys(firstRecord.responses).length;
            for (let i = 0; i < questionCount; i++) {
                csv += `Soru_${i + 1},`;
            }
            csv += 'Toplam_Puan,Ortalama_Skor,Yuzdelik_Puan,Seviye,Seviye_Metin,Geri_Bildirim\n';

            // Add data rows
            userData.records.forEach(record => {
                csv += `${record.date},${record.time},${record.timestamp},${userData.ageRange},${userData.gender},${record.mood},`;

                // Add responses
                for (const value of Object.values(record.responses)) {
                    csv += `${value},`;
                }

                csv += `${record.totalScore},${record.averageScore},${record.score},${record.level},${record.levelText},"${record.feedback.replace(/"/g, '""')}"\n`;
            });

            const csvBlob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(csvBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `feelaware_data_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            alert('CSV dosyasÄ± indirildi! Excel/SPSS ile aÃ§abilirsiniz.');
        }

        function clearAllData() {
            if (confirm('âš ï¸ TÃ¼m verileri silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz!')) {
                if (confirm('Son kez soruyorum: TÃ¼m deÄŸerlendirme kayÄ±tlarÄ±nÄ±z silinecek. Devam edilsin mi?')) {
                    userData.records = [];
                    saveData();
                    updateProfileDisplay();
                    updateDashboard();
                    closeSettings();
                    alert('âœ… TÃ¼m veriler silindi.');
                }
            }
        }

        function resetProfile() {
            if (!confirm('âš ï¸ Profilinizi ve tÃ¼m kayÄ±tlÄ± verilerinizi sÄ±fÄ±rlamak istiyor musunuz?')) return;
            if (!confirm('Son onay: TÃ¼m deÄŸerlendirme kayÄ±tlarÄ± silinecek. Devam edilsin mi?')) return;

            localStorage.removeItem('feelawareData');
            userData = {
                ageRange: null,
                gender: null,
                maritalStatus: null,
                region: null,
                records: []
            };

            // Reset setup form UI
            const ids = ['ageRange','gender','maritalStatus','region'];
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = '';
            });
            validateSetup();

            closeSettings();
            showScreen('setupScreen');
            alert('âœ… Profil sÄ±fÄ±rlandÄ±.');
        }


        // Initialize
        loadData();
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            document.getElementById('darkModeToggle').classList.add('active');
        }

        // Check if user has data and redirect
        window.onload = function() {
            loadData();
            if (userData.ageRange && userData.gender && userData.maritalStatus && userData.region) {
                console.log("Profil bulundu, panele yÃ¶nlendiriliyor...");
                goToDashboard();
            } else {
                console.log("Profil eksik, kurulum ekranÄ± gÃ¶steriliyor.");
                showScreen('setupScreen');
            }
        };
    </script>
</body>
</html>
